# ν¬νΈν΄λ¦¬μ¤ λ§¤λ„ μ•λ¦Ό κΈ°λ¥

- **λ‚ μ§**: 2026-01-26
- **μ΄μ**: μ—†μ
- **λΈλμΉ**: `feature/portfolio-sell-alert`
- **μƒνƒ**: μ™„λ£

## λ©ν‘

λ³΄μ  μΆ…λ©μ— λ€ν• λ§¤λ„ μ΅°κ±΄μ„ μ •μν•κ³ , μΌμΌ μ¤ν¬λ¦¬λ‹μ„ ν†µν•΄ λ§¤λ„ μ‹ νΈλ¥Ό ν™•μΈν•λ” μ‹μ¤ν… κµ¬μ¶•

## λ°°κ²½

- ν„μ¬ ν”„λ΅μ νΈμ— ν¬νΈν΄λ¦¬μ¤ κ΄€λ¦¬ μ „μ© λ¨λ“μ΄ μ—†μ
- μ¤ν¬λ¦¬λ‹ μ‹μ¤ν…μ€ μ΅΄μ¬ν•μ§€λ§, κ°μΈ ν¬νΈν΄λ¦¬μ¤ λ€μƒ λ§¤λ„ μ‹ νΈ ν™•μΈ κΈ°λ¥ λ¶€μ¬
- λ§¤μ/λ§¤λ„ μ΅°κ±΄μ„ μ‚¬μ „μ— μ •μν•κ³  μ €μ¥ν•  κ³µκ°„ ν•„μ”

## μ‘μ—… λ¶„λ¥

### Phase 1: ν¬νΈν΄λ¦¬μ¤ μ •μ μ‹μ¤ν…
λ³΄μ  μΆ…λ©κ³Ό λ§¤μ/λ§¤λ„ μ΅°κ±΄μ„ YAML νμΌλ΅ κ΄€λ¦¬

### Phase 2: λ§¤λ„ μ•λ¦Ό μ¤ν¬λ¦½νΈ
μ •μλ ν¬νΈν΄λ¦¬μ¤λ¥Ό λ€μƒμΌλ΅ λ§¤λ„ μ‹ νΈ ν™•μΈ

---

## Phase 1: ν¬νΈν΄λ¦¬μ¤ μ •μ μ‹μ¤ν…

### κ³„ν

- [x] 1λ‹¨κ³„: `config/portfolio.yaml` μ„¤μ • νμΌ μƒμ„±
  - λ³΄μ  μΆ…λ© λ©λ΅ (μ‹¬λ³Ό, λ§¤μκ°€, μλ‰, λ§¤μμΌ)
  - μΆ…λ©λ³„ λ§¤λ„ μ΅°κ±΄ (μ†μ κ°€, μµμ κ°€, κΈ°μ μ  μ΅°κ±΄)
  - κΈ°λ³Έ λ§¤λ„ μ΅°κ±΄ (μ „μ²΄ μ μ©)
- [x] 2λ‹¨κ³„: `screener/portfolio_manager.py` λ¨λ“ μƒμ„±
  - ν¬νΈν΄λ¦¬μ¤ YAML λ΅λ“/μ €μ¥
  - μΆ…λ© μ¶”κ°€/μμ •/μ‚­μ  κΈ°λ¥
  - ν„μ¬κ°€ λ€λΉ„ μ†μµ κ³„μ‚°
- [ ] 3λ‹¨κ³„: CLI λ…λ Ήμ–΄ μ¶”κ°€ (μ„ νƒ) - μ¶”ν›„ κµ¬ν„
  - `python run.py portfolio add AAPL --price 150 --qty 10`
  - `python run.py portfolio list`

### λ³€κ²½ νμΌ

| νμΌ | λ³€κ²½ λ‚΄μ© |
|------|----------|
| `config/portfolio.yaml` | μ‹ κ· - ν¬νΈν΄λ¦¬μ¤ μ„¤μ • νμΌ |
| `screener/portfolio_manager.py` | μ‹ κ· - ν¬νΈν΄λ¦¬μ¤ κ΄€λ¦¬ λ¨λ“ |
| `utils/config_manager.py` | μμ • - portfolio.yaml λ΅λ“ λ©”μ„λ“ μ¶”κ°€ |

### portfolio.yaml κµ¬μ΅° (μμ‹)

```yaml
# κΈ°λ³Έ λ§¤λ„ μ΅°κ±΄ (λ¨λ“  μΆ…λ©μ— μ μ©)
default_sell_conditions:
  stop_loss_pct: 0.05          # 5% μ†μ 
  take_profit_pct: 0.15        # 15% μµμ 
  trailing_stop_pct: 0.08      # 8% νΈλ μΌλ§ μ¤νƒ‘

# κΈ°μ μ  λ§¤λ„ μ΅°κ±΄
technical_sell_signals:
  - below_ma_20                 # 20μΌ μ΄ν‰μ„  ν•ν–¥ λν
  - death_cross                 # λ°μ¤ν¬λ΅μ¤ (λ‹¨κΈ°MA < μ¥κΈ°MA)
  - volume_spike_down           # κ±°λλ‰ κΈ‰μ¦ + ν•λ½

# λ³΄μ  μΆ…λ©
holdings:
  AAPL:
    buy_price: 150.00
    quantity: 10
    buy_date: "2025-06-15"
    # μΆ…λ©λ³„ μ»¤μ¤ν…€ μ΅°κ±΄ (κΈ°λ³Έκ°’ μ¤λ²„λΌμ΄λ“)
    custom_conditions:
      stop_loss_pct: 0.03       # μ΄ μΆ…λ©λ§ 3% μ†μ 

  NVDA:
    buy_price: 450.00
    quantity: 5
    buy_date: "2025-08-20"
    # κΈ°λ³Έ μ΅°κ±΄ μ‚¬μ©

  TSLA:
    buy_price: 250.00
    quantity: 8
    buy_date: "2025-10-01"
    custom_conditions:
      take_profit_pct: 0.25     # 25% μµμ  (λ³€λ™μ„± νΌ)
```

---

## Phase 2: λ§¤λ„ μ•λ¦Ό μ¤ν¬λ¦½νΈ

### κ³„ν

- [x] 1λ‹¨κ³„: `scripts/live/portfolio_sell_checker.py` μƒμ„±
  - ν¬νΈν΄λ¦¬μ¤ λ΅λ“
  - κ° μΆ…λ© ν„μ¬κ°€ μ΅°ν
  - κ°€κ²© κΈ°λ° λ§¤λ„ μ΅°κ±΄ μ²΄ν¬ (μ†μ /μµμ /νΈλ μΌλ§)
- [x] 2λ‹¨κ³„: κΈ°μ μ  λ§¤λ„ μ‹ νΈ λ¶„μ„ μ¶”κ°€
  - μ΄ν‰μ„ , λ°μ¤ν¬λ΅μ¤ λ¶„μ„ (portfolio_sell_checker.py λ‚΄ κµ¬ν„)
- [x] 3λ‹¨κ³„: κ²°κ³Ό μ¶λ ¥ ν¬λ§·
  - μ½μ†” μ¶λ ¥ (μ΄λ¨μ§€ + μƒ‰μƒ)
- [ ] 4λ‹¨κ³„: ν…μ¤νΈ - μ‚¬μ©μ ν…μ¤νΈ ν•„μ”

### λ³€κ²½ νμΌ

| νμΌ | λ³€κ²½ λ‚΄μ© |
|------|----------|
| `scripts/live/portfolio_sell_checker.py` | μ‹ κ· - λ§¤λ„ μ‹ νΈ ν™•μΈ μ¤ν¬λ¦½νΈ |
| (κΈ°μ μ  λ¶„μ„μ€ portfolio_sell_checker.py λ‚΄ κµ¬ν„) | |

### μ‹¤ν–‰ λ°©μ‹

```bash
# λ§¤λ„ μ‹ νΈ ν™•μΈ (μΌμΌ μ‹¤ν–‰)
python scripts/live/portfolio_sell_checker.py

# κ²°κ³Ό μμ‹
=====================================
π“ PORTFOLIO SELL CHECK - 2026-01-26
=====================================

Symbol   Buy Price   Current    P/L%    Signal       Reason
β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”
π”΄ AAPL  $150.00    $142.50    -5.0%   SELL         Stop loss triggered (-5%)
π΅ NVDA  $450.00    $480.00    +6.7%   WATCH        Near 20-day MA
πΆ TSLA  $250.00    $275.00    +10.0%  HOLD         All conditions OK

β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”
Summary: 1 SELL, 1 WATCH, 1 HOLD
```

---

## κΈ°μ μ  κ³ λ ¤μ‚¬ν•­

### μμ΅΄μ„±
- κΈ°μ΅΄ `screener/technical_filter.py` μ¬μ‚¬μ©
- `utils/fetch.py`λ΅ ν„μ¬κ°€ μ΅°ν
- `utils/config_manager.py` ν™•μ¥

### ν–¥ν›„ ν™•μ¥ κ°€λ¥μ„±
- μ΄λ©”μΌ/Slack μ•λ¦Ό μ—°λ™ (ν„μ¬ λ―Έμ§€μ›)
- μλ™ μ£Όλ¬Έ μ—°λ™ (Interactive Brokers)
- μ›Ή λ€μ‹λ³΄λ“

### μ£Όμμ‚¬ν•­
- `portfolio.yaml`μ€ λ―Όκ° μ •λ³΄ ν¬ν•¨ κ°€λ¥ β†’ `.gitignore`μ— μ¶”κ°€ κ³ λ ¤
- μ‹¤μ‹κ°„ κ°€κ²© μ΅°ν μ‹ API μ ν• μ£Όμ (yfinance)

---

## μ‘μ—… μμ„ μ μ•

1. **Phase 1 λ¨Όμ € μ™„λ£** β†’ ν¬νΈν΄λ¦¬μ¤ μ •μκ°€ μ„ ν–‰λμ–΄μ•Ό ν•¨
2. **Phase 2 μ§„ν–‰** β†’ μ •μλ ν¬νΈν΄λ¦¬μ¤λ΅ λ§¤λ„ μ²΄ν¬

---

## κ²°κ³Ό

### μƒμ„±λ νμΌ
1. `config/portfolio.yaml` - ν¬νΈν΄λ¦¬μ¤ μ„¤μ • (λ³΄μ  μΆ…λ©, λ§¤λ„ μ΅°κ±΄)
2. `screener/portfolio_manager.py` - ν¬νΈν΄λ¦¬μ¤ κ΄€λ¦¬ λ¨λ“
3. `scripts/live/portfolio_sell_checker.py` - λ§¤λ„ μ‹ νΈ ν™•μΈ μ¤ν¬λ¦½νΈ
4. `utils/config_manager.py` - portfolio κ΄€λ ¨ λ©”μ„λ“ μ¶”κ°€

### μ‚¬μ©λ²•
```bash
# 1. config/portfolio.yamlμ— λ³΄μ  μΆ…λ© μ¶”κ°€
# 2. λ§¤λ„ μ‹ νΈ ν™•μΈ μ‹¤ν–‰
python scripts/live/portfolio_sell_checker.py
```
